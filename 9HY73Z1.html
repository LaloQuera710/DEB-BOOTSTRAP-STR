<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this file,
   - You can obtain one at http://mozilla.org/MPL/2.0/. -->
<!DOCTYPE html>
print >> https://puerto53.com/linux/configuracion-de-un-servidor-nfs-en-linux/
<html platform="linux" dir="ltr" lang="en-US"><head>
    <title id="reader-title">▷ Configuración de un Servidor NFS en Linux ?【 Puerto53.com 】&nbsp;</title>
    <meta http-equiv="Content-Security-Policy" content="default-src chrome:; img-src data: *; media-src *; object-src 'none'">
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <meta name="viewport" content="width=device-width; user-scalable=0">
    <link rel="stylesheet" href="chrome://global/skin/aboutReader.css" type="text/css">
    <link rel="stylesheet" href="chrome://global/skin/aboutReaderPocket.css" type="text/css">
    <link rel="localization" href="toolkit/about/aboutReader.ftl">
    <link rel="localization" href="toolkit/branding/brandings.ftl">
  <link rel="stylesheet" href="chrome://global/skin/narrate.css"><link rel="shortcut icon" href="https://puerto53.com/wp-content/uploads/2017/09/53-100x100.jpg"></head>

  <body class="dark sans-serif loaded" style="--font-size: 20px; --content-width: 30em;">
    <div class="top-anchor"></div>

    <div id="toolbar" class="toolbar-container">
      <div class="toolbar reader-toolbar">
        <div class="reader-controls" articledir="ltr">
          <button class="close-button toolbar-button" aria-labelledby="toolbar-close" data-telemetry-id="reader-close">
            <span class="hover-label" id="toolbar-close" data-l10n-id="about-reader-toolbar-close">Close Reader View</span>
          </button>
          <ul class="dropdown style-dropdown">
            <li>
              <button class="dropdown-toggle toolbar-button style-button" aria-labelledby="toolbar-type-controls" data-telemetry-id="reader-type-controls">
                <span class="hover-label" id="toolbar-type-controls" data-l10n-id="about-reader-toolbar-type-controls">Type controls</span>
              </button>
            </li>
            <li class="dropdown-popup">
              <div class="dropdown-arrow"></div>
              <div class="font-type-buttons radiorow"><input id="radio-itemsans-serif-button" type="radio" class="radio-button" name="font-type" checked="checked"><label for="radio-itemsans-serif-button" class="sans-serif-button" data-l10n-id="about-reader-font-type-sans-serif" checked="true">Sans-serif</label><input id="radio-itemserif-button" type="radio" class="radio-button" name="font-type"><label for="radio-itemserif-button" class="serif-button" data-l10n-id="about-reader-font-type-serif">Serif</label></div>
              <div class="font-size-buttons buttonrow">
                <button class="minus-button" data-l10n-id="about-reader-toolbar-minus" title="Decrease Font Size"></button>
                <span class="font-size-value">5</span>
                <button class="plus-button" data-l10n-id="about-reader-toolbar-plus" title="Increase Font Size"></button>
              </div>
              <div class="content-width-buttons buttonrow">
                <button class="content-width-minus-button" data-l10n-id="about-reader-toolbar-contentwidthminus" title="Decrease Content Width"></button>
                <span class="content-width-value">3</span>
                <button class="content-width-plus-button" data-l10n-id="about-reader-toolbar-contentwidthplus" title="Increase Content Width"></button>
              </div>
              <div class="line-height-buttons buttonrow">
                <button class="line-height-minus-button" data-l10n-id="about-reader-toolbar-lineheightminus" title="Decrease Line Height"></button>
                <span class="line-height-value">4</span>
                <button class="line-height-plus-button" data-l10n-id="about-reader-toolbar-lineheightplus" title="Increase Line Height"></button>
              </div>
              <div class="color-scheme-buttons radiorow"><input id="radio-itemlight-button" type="radio" class="radio-button" name="color-scheme"><label for="radio-itemlight-button" class="light-button" data-l10n-id="about-reader-color-scheme-light" title="Color Scheme Light">Light</label><input id="radio-itemdark-button" type="radio" class="radio-button" name="color-scheme"><label for="radio-itemdark-button" class="dark-button" data-l10n-id="about-reader-color-scheme-dark" title="Color Scheme Dark">Dark</label><input id="radio-itemsepia-button" type="radio" class="radio-button" name="color-scheme"><label for="radio-itemsepia-button" class="sepia-button" data-l10n-id="about-reader-color-scheme-sepia" title="Color Scheme Sepia">Sepia</label><input id="radio-itemauto-button" type="radio" class="radio-button" name="color-scheme" checked="checked"><label for="radio-itemauto-button" class="auto-button" data-l10n-id="about-reader-color-scheme-auto" checked="true" title="Color Scheme Auto">Auto</label></div>
            </li>
          </ul>
        <ul class="dropdown narrate-dropdown"><li><button class="dropdown-toggle toolbar-button narrate-toggle" data-telemetry-id="reader-listen" aria-label="Listen (N)"><span class="hover-label">Listen (N)</span></button></li><li class="dropdown-popup"><div class="narrate-row narrate-control"><button class="narrate-skip-previous" disabled="disabled" title="Back"></button><button class="narrate-start-stop" title="Start (N)"></button><button class="narrate-skip-next" disabled="disabled" title="Forward"></button></div><div class="narrate-row narrate-rate"><input class="narrate-rate-input" value="0" step="5" max="100" min="-100" type="range" title="Speed"></div><div class="narrate-row narrate-voices"><div class="voiceselect voice-select"><button class="select-toggle" aria-controls="voice-options">
      <span class="label">Voice:</span> <span class="current-voice">Default</span>
    </button>
    <div class="options" id="voice-options" role="listbox"><button data-value="automatic" class="option selected" tabindex="-1" role="option" aria-selected="true">Default</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Jacky?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Iven3?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Pedro?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+male7?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+shelby?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+male5?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Michael?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+David?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Tweaky?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Steph?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+anika?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Alicia?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Robert?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Rob?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+RicishayMax2?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Mr_Serious?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Zac?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+sandro?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+RicishayMax?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Mario?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Boris?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+norbert?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+anxiousAndy?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Diogo?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+grandma?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Benjamin?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Steph3?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Robosoft7?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Alex?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+victor?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Andrea?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+travis?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Robosoft5?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+male2?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+female5?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Denis?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Gene?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Pablo?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Half-LifeAnnouncementSystem?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Robosoft6?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Auntie?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Iven2?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Adam?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+anikaRobot?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+fast_test?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Mike?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+whisper?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Marco?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Edward?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+female2?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+klatt6?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Robosoft2?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+male1?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+male6?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+klatt3?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Robosoft4?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Steph2?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Edward2?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Robosoft?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Kaukovalta?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Max?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Lee?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Iven4?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+RicishayMax3?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+UniversalRobot?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Belinda?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Miguel?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+male4?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+klatt5?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+female1?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+klatt2?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Ed?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Michel?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Gustave?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+female_whisper?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Gene2?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+grandpa?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Linda?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Annie?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Iven?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Hugo?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Storm?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Paul?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Henrique?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Demonic?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+male3?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+croak?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Robosoft8?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Marcelo?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Andy?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+female3?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+klatt?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Quincy?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+John?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Nguyen?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+female4?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Caleb?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Robosoft3?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+male8?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+Antonio?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Latin%20America)+klatt4?es-419" class="option" tabindex="-1" role="option">Spanish (es-419)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+klatt3?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Pedro?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Robosoft4?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Robosoft5?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Half-LifeAnnouncementSystem?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+male1?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Demonic?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Zac?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Andrea?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+klatt2?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Marcelo?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+anika?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Robosoft3?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Edward?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Edward2?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+female_whisper?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+whisper?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+male2?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+anxiousAndy?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Henrique?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Robosoft8?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Jacky?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Auntie?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+RicishayMax?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Gene2?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+travis?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+anikaRobot?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Robosoft?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+RicishayMax3?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+female4?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+RicishayMax2?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+grandpa?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Adam?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Iven?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Annie?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Steph2?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+klatt?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Denis?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Robosoft6?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+norbert?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Iven3?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Alex?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Gene?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Caleb?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Rob?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Tweaky?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Michel?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Alicia?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Robosoft7?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+sandro?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+David?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Diogo?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Hugo?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Miguel?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Iven2?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+female3?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Mr_Serious?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+female1?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+male3?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Linda?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Antonio?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Marco?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+male5?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+female2?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Storm?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+grandma?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Kaukovalta?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Belinda?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+John?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+UniversalRobot?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+male7?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+klatt4?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Nguyen?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Robert?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Ed?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Michael?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+female5?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Andy?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Steph?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Gustave?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Lee?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Mike?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Pablo?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Steph3?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Robosoft2?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Boris?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+fast_test?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+shelby?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Paul?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+male4?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+croak?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Quincy?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+klatt5?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Max?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+male6?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+victor?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Benjamin?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+klatt6?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Mario?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+Iven4?es" class="option" tabindex="-1" role="option">Spanish (es)</button><button data-value="urn:moz-tts:speechd:Spanish%20(Spain)+male8?es" class="option" tabindex="-1" role="option">Spanish (es)</button></div></div></div><div class="dropdown-arrow"></div></li></ul><button data-buttonid="pocket-button" data-telemetry-id="reader-save-to-pocket" class="toolbar-button pocket-button" aria-labelledby="label-pocket-button" style="background-image: url(&quot;chrome://global/skin/icons/pocket.svg&quot;);"><span class="hover-label" id="label-pocket-button" data-l10n-id="about-reader-toolbar-savetopocket">Save To Pocket</span></button></div>
      </div>
    </div>

    <div class="container" style="--line-height: 1.6em;" dir="ltr" lang="es">
      <div class="header reader-header reader-show-element">
        <a class="domain reader-domain" href="https://puerto53.com/linux/configuracion-de-un-servidor-nfs-en-linux/">puerto53.com</a>
        <div class="domain-border"></div>
        <h1 class="reader-title">▷ Configuración de un Servidor NFS en Linux ?【 Puerto53.com 】</h1>
        <div class="credits reader-credits"></div>
        <div class="meta-data">
          <div class="reader-estimated-time" data-l10n-args="{&quot;range&quot;:&quot;32–41&quot;,&quot;rangePlural&quot;:&quot;other&quot;}" data-l10n-id="about-reader-estimated-read-time" dir="ltr">32–41 minutes</div>
        </div>
      </div>

      <hr>

      <div class="content">
        <div class="moz-reader-content reader-show-element"><div id="readability-page-1" class="page"><div itemprop="text"><div id="ez-toc-container"><nav><ul><li><a href="#%C2%BFQue_es_NFS" title="¿Qué es NFS?">¿Qué es NFS?</a></li><li><a href="#%C2%BFComo_se_instala_un_servidor_NFS_en_Linux" title="¿Cómo se instala un servidor NFS en Linux?">¿Cómo se instala un servidor NFS en Linux?</a></li><li><a href="#%C2%BFComo_compartimos_un_filesystem_con_otros_servidores_remotos_con_NFS" title="¿Cómo compartimos un filesystem con otros servidores remotos con NFS?">¿Cómo compartimos un filesystem con otros servidores remotos con NFS?</a><ul><li><a href="#Opciones_de_exportacion_en_el_fichero_etcexports" title="Opciones de exportación en el fichero /etc/exports">Opciones de exportación en el fichero /etc/exports</a></li></ul></li><li><a href="#Configuracion_de_NFS_para_optimizar_el_rendimiento" title="Configuración de NFS para optimizar el rendimiento">Configuración de NFS para optimizar el rendimiento</a><ul><li><a href="#Cliente_de_NFS" title="Cliente de NFS">Cliente de NFS</a><ul><li><a href="#Pruebas_de_estres_de_NFS_con_diferentes_opciones_de_montaje_y_tipos_de_filesystems" title="Pruebas de estrés de NFS con diferentes opciones de montaje y tipos de filesystems">Pruebas de estrés de NFS con diferentes opciones de montaje y tipos de filesystems</a><ul><li><a href="#Rendimiento_de_un_filesystem_EXT4_vs_XFS" title="Rendimiento de un filesystem EXT4 vs XFS">Rendimiento de un filesystem EXT4 vs XFS</a></li><li><a href="#Rendimiento_de_un_filesystem_montado_con_NFS3_vs_NFS4" title="Rendimiento de un filesystem montado con NFS3 vs NFS4">Rendimiento de un filesystem montado con NFS3 vs NFS4</a></li></ul></li><li><a href="#Modificamos_los_parametros_rsize8192wsize8192" title="Modificamos los parámetros rsize=8192,wsize=8192">Modificamos los parámetros rsize=8192,wsize=8192</a><ul><li><a href="#Anadimos_el_parametro_noatime_y_eliminamos_rsize_y_wsize" title="Añadimos el parámetro noatime y eliminamos rsize y wsize">Añadimos el parámetro noatime y eliminamos rsize y wsize</a></li><li><a href="#Anadimos_el_parametro_async" title="Añadimos el parámetro async">Añadimos el parámetro async</a></li><li><a href="#Sustitucion_de_hard_por_soft" title="Sustitución de hard por soft">Sustitución de hard por soft</a></li><li><a href="#En_el_servidor_NFS_sustituimos_async_por_sync" title="En el servidor NFS sustituimos async por sync">En el servidor NFS sustituimos async por sync</a></li></ul></li></ul></li><li><a href="#Servidor_de_NFS" title="Servidor de NFS">Servidor de NFS</a></li></ul></li><li><a href="#Entonces_%C2%BFcon_que_opciones_de_montaje_nos_quedamos" title="Entonces, ¿con qué opciones de montaje nos quedamos?">Entonces, ¿con qué opciones de montaje nos quedamos?</a><ul><li><a href="#Servidor_NFS" title="Servidor NFS">Servidor NFS</a></li><li><a href="#Cliente_NFS" title="Cliente NFS">Cliente NFS</a></li><li><a href="#Opciones_de_montaje_NFS_para_Oracle_RMAN" title="Opciones de montaje NFS para Oracle RMAN">Opciones de montaje NFS para Oracle RMAN</a></li></ul></li><li><a href="#%C2%BFComo_modificar_el_numero_de_threads_en_el_servidor_de_NFS" title="¿Cómo modificar el número de threads en el servidor de NFS?">¿Cómo modificar el número de threads en el servidor de NFS?</a></li><li><a href="#Configurar_un_directorio_virtual_con_NFS4" title="Configurar un directorio virtual con NFS4">Configurar un directorio virtual con NFS4</a><ul><li><a href="#Configuracion_del_servidor_NFS" title="Configuración del servidor NFS">Configuración del servidor NFS</a></li><li><a href="#Configuracion_del_cliente_NFS" title="Configuración del cliente NFS">Configuración del cliente NFS</a></li><li><a href="#Error_mounting_XXX_failed_reason_given_by_server_No_such_file_or_directory" title="Error mounting XXX failed, reason given by server: No such file or directory">Error mounting XXX failed, reason given by server: No such file or directory</a></li></ul></li><li><a href="#Escribir_un_fichero_desde_el_cliente_NFS_con_un_usuario_que_no_existe" title="Escribir un fichero desde el cliente NFS con un usuario que no existe">Escribir un fichero desde el cliente NFS con un usuario que no existe</a></li><li><a href="#Errores_comunes_con_el_servicio_de_NFS" title="Errores comunes con el servicio de NFS">Errores comunes con el servicio de NFS</a><ul><li><a href="#Error_de_NFS_%E2%80%93_server_XXX_not_responding_timed_out" title="Error de NFS – server XXX not responding, timed out">Error de NFS – server XXX not responding, timed out</a></li><li><a href="#RPC_fragment_too_large" title="RPC: fragment too large">RPC: fragment too large</a></li><li><a href="#mountnfs_Protocol_not_supported" title="mount.nfs: Protocol not supported">mount.nfs: Protocol not supported</a></li><li><a href="#kernel_nfsd_peername_failed_err_107" title="kernel: nfsd: peername failed (err 107)">kernel: nfsd: peername failed (err 107)</a></li><li><a href="#Stale_file_handle" title="Stale file handle">Stale file handle</a></li><li><a href="#Los_ficheros_se_ven_con_el_propietario_nobody_nobody_en_el_cliente_NFS_con_NFS4" title="Los ficheros se ven con el propietario nobody:nobody en el cliente NFS con NFS4">Los ficheros se ven con el propietario nobody:nobody en el cliente NFS con NFS4</a></li><li><a href="#El_servidor_de_NFS_no_responde_pero_hay_comunicacion" title="El servidor de NFS no responde pero hay comunicación">El servidor de NFS no responde pero hay comunicación</a></li><li><a href="#Te_puede_interesar" title="Te puede interesar">Te puede interesar</a></li></ul></li></ul></nav></div><h2><span id="%C2%BFQue_es_NFS"></span>¿Qué es NFS?<span></span></h2><p>NFS o Network Filesystem es un sistema de archivos que se utiliza para compartir datos con otros servidores a través de la red.</p><p>El servidor NFS es el propietario del filesystem que va a compartir con otros servidores remotos o clientes.</p><figure><p data-placeholder_class_index="1" data-placeholder-image="https://puerto53.com/wp-content/uploads/complianz/placeholders/youtubedfBDYSGb1_w-maxresdefault.webp">
</p></figure><p>NFS Linux utiliza un sistema de archivos centralizado 
para acceder al almacenamiento de red y proporciona protocolo de 
bloqueos y desbloqueos para evitar la corrupción de datos y permitir 
operaciones concurrentes de lectura y escritura sobre el filesystem.</p><p>Para
 usar NFS, debemos instalar el software del servidor (nfs-server), para 
poder exportar filesystems, y el software del cliente (nfs-client) para 
poder montar los filesystems en los servidores remotos (clientes). En 
las opciones de exportación podremos restringir los permisos, usuarios e
 IPs remotas que podrán acceder al sistema de archivos.</p><p>Para que un filesystem NFS se monte al iniciar el sistema cliente, deberemos configurar el fichero /etc/fstab o <a href="https://puerto53.com/linux/autofs-montaje-automatico-de-filesystems-en-linux/">autofs</a>.</p><p>Para
 exportar los filesystems en el lado del servidor, deberemos configurar 
el fichero /etc/exports, especifiando el filesystem a exportar, los 
servidores remotos que pueden acceder a él y con qué permisos.</p><p>En NFS 4, tanto el cliente como el servidor solamente utilizan el puerto 2049 TCP.</p><h2><span id="%C2%BFComo_se_instala_un_servidor_NFS_en_Linux"></span>¿Cómo se instala un servidor NFS en Linux?<span></span></h2><p>En Linux CentOS 8 instalaremos los siguientes paquetes:</p><pre><code>[root@ip-10-0-3-108 ~]# dnf install -y nfs-utils
[root@ip-10-0-3-108 ~]# rpm -qa |grep -i nfs
nfs-utils-2.3.3-35.el8.x86_64
sssd-nfs-idmap-2.3.0-9.el8.x86_64
libnfsidmap-2.3.3-35.el8.x86_64
[root@ip-10-0-3-108 ~]#
</code></pre><p>Una vez instalado el software, habilitaremos el servicio:</p><pre><code>[root@ip-10-0-3-108 ~]# systemctl enable nfs-server
[root@ip-10-0-3-108 ~]# systemctl start nfs-server

[root@ip-10-0-3-108 ~]# systemctl status nfs-server
● nfs-server.service - NFS server and services
   Loaded: loaded (/usr/lib/systemd/system/nfs-server.service; enabled; vendor preset: disabled)
  Drop-In: /run/systemd/generator/nfs-server.service.d
           └─order-with-mounts.conf
   Active: active (exited) since Fri 2021-04-23 19:04:53 UTC; 32min ago
  Process: 1208 ExecStopPost=/usr/sbin/exportfs -f (code=exited, status=0/SUCCESS)
  Process: 1205 ExecStopPost=/usr/sbin/exportfs -au (code=exited, status=0/SUCCESS)
  Process: 1203 ExecStop=/usr/sbin/rpc.nfsd 0 (code=exited, status=0/SUCCESS)
  Process: 1229 ExecStart=/bin/sh -c if systemctl -q is-active gssproxy; then systemctl reload gssproxy ; fi (code=exited, status=0/SUCCESS)
  Process: 1219 ExecStart=/usr/sbin/rpc.nfsd (code=exited, status=0/SUCCESS)
  Process: 1217 ExecStartPre=/usr/sbin/exportfs -r (code=exited, status=0/SUCCESS)
 Main PID: 1229 (code=exited, status=0/SUCCESS)
    Tasks: 0 (limit: 24941)
   Memory: 0B
   CGroup: /system.slice/nfs-server.service

Apr 23 19:04:53 ip-10-0-3-108.eu-west-1.compute.internal systemd[1]: Starting NFS server and services...
Apr 23 19:04:53 ip-10-0-3-108.eu-west-1.compute.internal systemd[1]: Started NFS server and services.
[root@ip-10-0-3-108 ~]#
</code></pre><h2><span id="%C2%BFComo_compartimos_un_filesystem_con_otros_servidores_remotos_con_NFS"></span>¿Cómo compartimos un filesystem con otros servidores remotos con NFS?<span></span></h2><p>Esta
 es una de las tareas más sencillas. En el servidor de NFS 
configuraremos el archivo /etc/exports con los servidores que deben 
tener acceso. Por ejemplo:</p><pre><code>[root@ip-10-0-3-108 ~]# cat /etc/exports
/nfssrv 10.0.3.135(sync,rw) 10.0.3.136(sync,rw)
[root@ip-10-0-3-108 ~]#
[root@ip-10-0-3-108 ~]# exportfs -av
exporting 10.0.3.135:/nfssrv

</code></pre><p>En el lado del cliente, configuraremos el punto de montaje correspondiente en el fichero /etc/fstab. Ejemplo:</p><pre><code>[root@ip-10-0-3-135 ~]# grep nfs /etc/fstab |grep -v "#"
10.0.3.108:/nfssrv      /clntnfs        nfs     vers=4,noatime,async,rw,hard,timeo=600,retrans=30       0 0
[root@ip-10-0-3-135 ~]#


[root@ip-10-0-3-135 ~]# su - david
Last login: Fri Apr 23 19:07:45 UTC 2021 on pts/0
[david@ip-10-0-3-135 ~]$ cd /clntnfs/
[david@ip-10-0-3-135 clntnfs]$ ls -la
total 15728656
drwxr-xr-x   2 david david        296 Apr 23 19:23 .
dr-xr-xr-x. 18 root  root         259 Apr 23 16:52 ..
-rw-------   1 david david 1073741824 Apr 23 19:26 test_file.0
-rw-------   1 david david 1073741824 Apr 23 19:26 test_file.1

[david@ip-10-0-3-135 clntnfs]$ df -hP .
Filesystem          Size  Used Avail Use% Mounted on
10.0.3.108:/nfssrv   20G   16G  4.9G  76% /clntnfs
[david@ip-10-0-3-135 clntnfs]$

</code></pre><p>Dependiendo del uso que le vayamos a dar a NFS, 
deberemos utilizar unas opciones de montaje u otras. Para ello, 
tendremos que echar un vistazo al man de nfs, de fstab y de mount.</p><h3><span id="Opciones_de_exportacion_en_el_fichero_etcexports"></span>Opciones de exportación en el fichero /etc/exports<span></span></h3><p><strong>ro</strong></p><p>El sistema de archivos exportado sólo es de lectura, por lo que los hosts remotos no pueden modificar los datos compartidos.</p><p><strong>rw</strong></p><p>Para permitir la edición a través de los hosts remotos (leer y escribir), es necesario especificar la opción de ‘rw’.</p><p><strong>sync</strong></p><p>La
 sincronización por defecto significa que el servidor NFS no responderá a
 las solicitudes antes de que los cambios se escriban en el disco. Para 
permitir las escrituras asíncronas en su lugar, es necesario especificar
 la opción ‘<strong>async</strong>‘.</p><p><strong>root_squash</strong></p><p>Para
 evitar que los usuarios root conectados remotamente tengan privilegios 
de root, se puede usar la opción ‘root_squash’.  Si queremos que el 
usuario root del servidor remoto tenga privilegios de root, usaremos <strong>no_root_squash</strong>.</p><p><strong>wdelay</strong></p><p>Las
 escrituras en disco se retrasan si el servidor NFS sospecha que hay 
otra escritura prioritara de forma inminente. Esta opción puede mejorar 
el rendimiento de escritura en disco al reducir el número de accesos al 
disco, reduciendo la sobrecarga de escritura.</p><h2><span id="Configuracion_de_NFS_para_optimizar_el_rendimiento"></span>Configuración de NFS para optimizar el rendimiento<span></span></h2><h3><span id="Cliente_de_NFS"></span>Cliente de NFS<span></span></h3><p>Cuando
 hablamos de rendimiento nos referimos a la velocidad de lectura y 
escritura  de datos en el filesystem montado en los clientes NFS.</p><p>Os
 adelanto, que las opciones de montaje con «async» tanto en el lado del 
servidor como en el del cliente son las más rápidas pero no es la opción
 recomendada por temas de seguridad e integridad de los datos.</p><p>Mejor
 vemos una serie de pruebas de estrés y vemos las diferencias de 
rendimiento entre cada una de las opciones de montaje y, al final, 
decidimos cuáles son las que más nos convienen.</p><h4><span id="Pruebas_de_estres_de_NFS_con_diferentes_opciones_de_montaje_y_tipos_de_filesystems"></span>Pruebas de estrés de NFS con diferentes opciones de montaje y tipos de filesystems<span></span></h4><p>Para ejecutar las pruebas de estrés he utilizado <a href="https://puerto53.com/linux/realizar-pruebas-de-estres-con-sysbench/"><em>sysbench</em> (ver tutorial)</a>.</p><h5><span id="Rendimiento_de_un_filesystem_EXT4_vs_XFS"></span>Rendimiento de un filesystem EXT4 vs XFS<span></span></h5><ul><li>Tamaño medio de los archivos:<ul><li>Opciones de montaje del FS: vers=3,rw,hard,timeo=600,retrans=30</li><li>Comando lanzado:<ul><li>Preparación: sysbench fileio –file-total-size=15G prepare</li><li>Test de rendimiento: sysbench fileio –file-total-size=15G –file-test-mode=rndrw run</li></ul></li></ul></li></ul><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjE3MSIgdmlld0JveD0iMCAwIDEwMjQgMTcxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-2-1024x171.png" alt="image 2" title="Configuración de un Servidor NFS en Linux 1" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-2-1024x171.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-2-300x50.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-2-768x128.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-2.png 1499w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="171"><figcaption>Configuración de un Servidor NFS en Linux 20</figcaption></figure><ul><li>Pocos archivos grandes:<ul><li>Opciones de montaje del FS: vers=3,rw,hard,timeo=600,retrans=30</li><li>Comando lanzado:<ul><li>Preparación de sysbench: sysbench fileio –file-total-size=15G prepare –file-num=15</li><li>Test de rendimiento: sysbench fileio –file-num=15 –file-test-mode=rndrw run</li></ul></li></ul></li></ul><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjE3MyIgdmlld0JveD0iMCAwIDEwMjQgMTczIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-3-1024x173.png" alt="image 3" title="Configuración de un Servidor NFS en Linux 2" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-3-1024x173.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-3-300x51.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-3-768x130.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-3.png 1499w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="173"><figcaption>Configuración de un Servidor NFS en Linux 21</figcaption></figure><p>Por lo tanto XFS tiene un mejor rendimiento que EXT4.</p><h5><span id="Rendimiento_de_un_filesystem_montado_con_NFS3_vs_NFS4"></span>Rendimiento de un filesystem montado con NFS3 vs NFS4<span></span></h5><ul><li>Tamaño medio de los archivos:<ul><li>Opciones de montaje del FS: vers=4,rw,hard,timeo=600,retrans=30</li><li>Comando lanzado:<ul><li>Preparación: sysbench fileio –file-total-size=15G prepare</li><li>Test de rendimiento: sysbench fileio –file-total-size=15G –file-test-mode=rndrw run</li></ul></li></ul></li></ul><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjE3NiIgdmlld0JveD0iMCAwIDEwMjQgMTc2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-4-1024x176.png" alt="image 4" title="Configuración de un Servidor NFS en Linux 3" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-4-1024x176.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-4-300x52.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-4-768x132.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-4.png 1502w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="176"><figcaption>Configuración de un Servidor NFS en Linux 22</figcaption></figure><p>Me ha sorprendido que en estas pruebas NFS4 haya rendido un poco menos que NFS3, ya que, según la <a href="https://es.wikipedia.org/wiki/Network_File_System" target="_blank" rel="noopener">documentación oficial</a>,
 NFS4 ha de rendir mejor que NFS3. En cualquier caso, la robustez y 
mecanismos de seguridad de las nuevas versiones es superior en la v4 que
 la v3.</p><ul><li>Pocos archivos grandes<ul><li>Opciones de montaje del FS: vers=4,rw,hard,timeo=600,retrans=30</li><li>Comando lanzado<ul><li>Preparación de sysbench: sysbench fileio –file-total-size=15G prepare –file-num=15</li><li>Test de rendimiento: sysbench fileio –file-num=15 –file-test-mode=rndrw run</li></ul></li></ul></li></ul><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjE3NCIgdmlld0JveD0iMCAwIDEwMjQgMTc0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-5-1024x174.png" alt="image 5" title="Configuración de un Servidor NFS en Linux 4" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-5-1024x174.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-5-300x51.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-5-768x131.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-5.png 1499w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="174"><figcaption>Configuración de un Servidor NFS en Linux 23</figcaption></figure><p>De nuevo, NFS3 ofrece un ligero mejor rendimiento que NFS4.</p><h4><span id="Modificamos_los_parametros_rsize8192wsize8192"></span>Modificamos los parámetros rsize=8192,wsize=8192<span></span></h4><ul><li>Tamaño medio de los archivos<ul><li>Opciones de montaje del FS: vers=4,rsize=8192,wsize=8192,rw,hard,timeo=600,retrans=30</li><li>Comando lanzado:<ul><li>Preparación: sysbench fileio –file-total-size=15G prepare</li><li>Test de rendimiento: sysbench fileio –file-total-size=15G –file-test-mode=rndrw run</li></ul></li></ul></li></ul><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjE4MyIgdmlld0JveD0iMCAwIDEwMjQgMTgzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-6-1024x183.png" alt="image 6" title="Configuración de un Servidor NFS en Linux 5" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-6-1024x183.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-6-300x53.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-6-768x137.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-6-1536x274.png 1536w, https://puerto53.com/wp-content/uploads/2021/04/image-6.png 1554w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="183"><figcaption>Configuración de un Servidor NFS en Linux 24</figcaption></figure><ul><li>Pocos archivos grandes:<ul><li>Opciones de montaje del FS: vers=4,rsize=8192,wsize=8192,rw,hard,timeo=600,retrans=30</li><li>Comando lanzado<ul><li>Preparación de sysbench: sysbench fileio –file-total-size=15G prepare –file-num=15</li><li>Test de rendimiento: sysbench fileio –file-num=15 –file-test-mode=rndrw run</li></ul></li></ul></li></ul><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjE2OCIgdmlld0JveD0iMCAwIDEwMjQgMTY4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-7-1024x168.png" alt="image 7" title="Configuración de un Servidor NFS en Linux 6" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-7-1024x168.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-7-300x49.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-7-768x126.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-7-1536x252.png 1536w, https://puerto53.com/wp-content/uploads/2021/04/image-7.png 1554w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="168"><figcaption>Configuración de un Servidor NFS en Linux 25</figcaption></figure><h5><span id="Anadimos_el_parametro_noatime_y_eliminamos_rsize_y_wsize"></span>Añadimos el parámetro noatime y eliminamos rsize y wsize<span></span></h5><ul><li>Tamaño medio de los archivos<ul><li>Opciones de montaje del FS: vers=4,noatime,rw,hard,timeo=600,retrans=30</li><li>Comando lanzado:<ul><li>Preparación: sysbench fileio –file-total-size=15G prepare</li><li>Test de rendimiento: sysbench fileio –file-total-size=15G –file-test-mode=rndrw run</li></ul></li></ul></li></ul><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjE2OCIgdmlld0JveD0iMCAwIDEwMjQgMTY4Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-8-1024x168.png" alt="image 8" title="Configuración de un Servidor NFS en Linux 7" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-8-1024x168.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-8-300x49.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-8-768x126.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-8-1536x252.png 1536w, https://puerto53.com/wp-content/uploads/2021/04/image-8.png 1550w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="168"><figcaption>Configuración de un Servidor NFS en Linux 26</figcaption></figure><ul><li>Pocos archivos grandes<ul><li>Opciones de montaje del FS: vers=4,noatime,rw,hard,timeo=600,retrans=30</li><li>Comando lanzado<ul><li>Preparación de sysbench: sysbench fileio –file-total-size=15G prepare –file-num=15</li><li>Test de rendimiento: sysbench fileio –file-num=15 –file-test-mode=rndrw run</li></ul></li></ul></li></ul><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjE2NiIgdmlld0JveD0iMCAwIDEwMjQgMTY2Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-9-1024x166.png" alt="image 9" title="Configuración de un Servidor NFS en Linux 8" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-9-1024x166.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-9-300x49.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-9-768x125.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-9-1536x249.png 1536w, https://puerto53.com/wp-content/uploads/2021/04/image-9.png 1552w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="166"><figcaption>Configuración de un Servidor NFS en Linux 27</figcaption></figure><p>Aunque
 no hay mucha diferencia de rendimiento si añadimos “noatime” es 
recomendable añadir esta opción porque sirve para guardar la información
 del último acceso al fichero. Con que esto solamente lo haga el 
servidor de NFS es suficiente. No hace falta que lo hagan el servidor y 
el cliente.</p><h5><span id="Anadimos_el_parametro_async"></span>Añadimos el parámetro async<span></span></h5><ul><li>Tamaño medio de los archivos<ul><li>En el servidor de NFS exportamos el FS con async (/etc/exports)</li><li>Opciones de montaje del FS: vers=4,noatime,async,rw,hard,timeo=600,retrans=30</li><li>Comando lanzado:<ul><li>Preparación: sysbench fileio –file-total-size=15G prepare</li><li>Test de rendimiento: sysbench fileio –file-total-size=15G –file-test-mode=rndrw run</li></ul></li></ul></li></ul><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjEzMyIgdmlld0JveD0iMCAwIDEwMjQgMTMzIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-10-1024x133.png" alt="image 10" title="Configuración de un Servidor NFS en Linux 9" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-10-1024x133.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-10-300x39.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-10-768x100.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-10-1536x199.png 1536w, https://puerto53.com/wp-content/uploads/2021/04/image-10.png 1550w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="133"><figcaption>Configuración de un Servidor NFS en Linux 28</figcaption></figure><p><strong>Con async en el lado del servidor y en el del cliente, el rendimiento tanto de lectura como de escritura supera el 83%.</strong></p><ul><li>Pocos archivos grandes:<ul><li>En el servidor de NFS exportamos el FS con async (/etc/exports)</li><li>Opciones de montaje del FS: vers=4,noatime,async,rw,hard,timeo=600,retrans=30</li><li>Comando lanzado:<ul><li>Preparación: sysbench fileio –file-total-size=15G prepare</li><li>Test de rendimiento: sysbench fileio –file-num=15 &nbsp;–file-test-mode=rndrw run</li></ul></li></ul></li></ul><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjEzMSIgdmlld0JveD0iMCAwIDEwMjQgMTMxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-11-1024x131.png" alt="image 11" title="Configuración de un Servidor NFS en Linux 10" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-11-1024x131.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-11-300x38.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-11-768x98.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-11-1536x197.png 1536w, https://puerto53.com/wp-content/uploads/2021/04/image-11.png 1545w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="131"><figcaption>Configuración de un Servidor NFS en Linux 29</figcaption></figure><p>La mejora de rendimiento no es tan pronunciada cuando trabajamos con archivos grandes pero sigue siendo superior.</p><h5><span id="Sustitucion_de_hard_por_soft"></span>Sustitución de hard por soft<span></span></h5><ul><li>Tamaño medio de los archivos<ul><li>En el servidor de NFS exportamos el FS con async (/etc/exports)</li><li>Opciones de montaje del FS: vers=4,noatime,async,rw,soft,timeo=600,retrans=30</li><li>Comando lanzado:<ul><li>Preparación: sysbench fileio –file-total-size=15G prepare</li><li>Test de rendimiento: sysbench fileio –file-total-size=15G –file-test-mode=rndrw run</li></ul></li></ul></li></ul><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjEzNSIgdmlld0JveD0iMCAwIDEwMjQgMTM1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-12-1024x135.png" alt="image 12" title="Configuración de un Servidor NFS en Linux 11" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-12-1024x135.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-12-300x39.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-12-768x101.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-12-1536x202.png 1536w, https://puerto53.com/wp-content/uploads/2021/04/image-12.png 1551w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="135"><figcaption>Configuración de un Servidor NFS en Linux 30</figcaption></figure><ul><li>Pocos archivos grandes:<ul><li>Opciones de montaje del FS: vers=4,noatime,rw,soft,timeo=600,retrans=30</li><li>Comando lanzado<ul><li>Preparación de sysbench: sysbench fileio –file-total-size=15G prepare –file-num=15</li><li>Test de rendimiento: sysbench fileio –file-num=15 –file-test-mode=rndrw run</li></ul></li></ul></li></ul><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjEzNCIgdmlld0JveD0iMCAwIDEwMjQgMTM0Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-13-1024x134.png" alt="image 13" title="Configuración de un Servidor NFS en Linux 12" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-13-1024x134.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-13-300x39.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-13-768x100.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-13-1536x200.png 1536w, https://puerto53.com/wp-content/uploads/2021/04/image-13.png 1549w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="134"><figcaption>Configuración de un Servidor NFS en Linux 31</figcaption></figure><p>No se ven mejoras de rendimiento demasiado pronunciadas pero es mejor utilizar hard por una mejor integridad de los datos.</p><h5><span id="En_el_servidor_NFS_sustituimos_async_por_sync"></span>En el servidor NFS sustituimos async por sync<span></span></h5><ul><li>Tamaño medio de los archivos:<ul><li>En el servidor de NFS exportamos el FS con sync (/etc/exports)</li><li>Opciones de montaje del FS: vers=4,noatime,async,rw,hard,timeo=600,retrans=30</li><li>Comando lanzado:<ul><li>Preparación: sysbench fileio –file-total-size=15G prepare</li><li>Test de rendimiento: sysbench fileio –file-total-size=15G –file-test-mode=rndrw run</li></ul></li></ul></li></ul><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjEzNSIgdmlld0JveD0iMCAwIDEwMjQgMTM1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-14-1024x135.png" alt="image 14" title="Configuración de un Servidor NFS en Linux 13" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-14-1024x135.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-14-300x40.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-14-768x101.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-14-1536x203.png 1536w, https://puerto53.com/wp-content/uploads/2021/04/image-14.png 1553w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="135"><figcaption>Configuración de un Servidor NFS en Linux 32</figcaption></figure><p>La
 opción async en el lado del servidor NFS mejora el rendimiento respecto
 a sync en un 49% para lectura y un 45% para escritura, sin embargo, la 
integridad de los datos puede verse comprometida.</p><ul><li>Pocos archivos grandes:<ul><li>Opciones de montaje del FS: vers=4,noatime,async,rw,hard,timeo=600,retrans=30</li><li>Comando lanzado:<ul><li>Preparación: sysbench fileio –file-total-size=15G prepare –file-num=15</li><li>Test de rendimiento: sysbench fileio –file-num=15 –file-test-mode=rndrw run</li></ul></li></ul></li></ul><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjEzNSIgdmlld0JveD0iMCAwIDEwMjQgMTM1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-15-1024x135.png" alt="image 15" title="Configuración de un Servidor NFS en Linux 14" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-15-1024x135.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-15-300x40.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-15-768x101.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-15-1536x203.png 1536w, https://puerto53.com/wp-content/uploads/2021/04/image-15.png 1552w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="135"><figcaption>Configuración de un Servidor NFS en Linux 33</figcaption></figure><h3><span id="Servidor_de_NFS"></span>Servidor de NFS<span></span></h3><p>He
 hecho algunas pruebas de estrés tanto en el lado del cliente como del 
servidor de NFS modificando el número de threads del servidor de NFS, 
modificando el tipo de disco en el servidor de NFS y comprobando el 
rendimiento en el cliente NFS de un servidor virtual con uno físico.</p><p>Veamos el resultado de las pruebas:</p><ul><li>El servidor NFS es físico con 32 cores y 377GB de RAM</li><li>Comandos de rendimiento utilizados:</li></ul><pre><code>sysbench fileio --file-total-size=15G --file-test-mode=rndrw --time=300 --max-requests=0 prepare

sysbench fileio --file-total-size=15G --file-test-mode=rndrw --time=300 --max-requests=0 run   1 thread

sysbench fileio --file-total-size=15G --file-test-mode=rndrw --time=300 --max-requests=0 run --threads=8  8 threads

sysbench fileio --file-total-size=15G --file-test-mode=rndrw --time=300 --max-requests=0 cleanup
</code></pre><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjEyMiIgdmlld0JveD0iMCAwIDEwMjQgMTIyIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/10/image-2-1024x122.png" alt="Pruebas de rendimiento de NFS con Sysbench" title="Configuración de un Servidor NFS en Linux 15" data-srcset="https://puerto53.com/wp-content/uploads/2021/10/image-2-1024x122.png 1024w, https://puerto53.com/wp-content/uploads/2021/10/image-2-300x36.png 300w, https://puerto53.com/wp-content/uploads/2021/10/image-2-768x91.png 768w, https://puerto53.com/wp-content/uploads/2021/10/image-2-1536x183.png 1536w, https://puerto53.com/wp-content/uploads/2021/10/image-2.png 1596w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="122"><figcaption>A continuación, <strong>aumentamos el número de threads de 8 a 512</strong> en el servidor de NFS. Según el siguiente documento de Oracle (<a href="https://docs.oracle.com/cd/E19620-01/805-4448/z40000292837/index.html" target="_blank" rel="noreferrer noopener">https://docs.oracle.com/cd/E19620-01/805-4448/z40000292837/index.htm</a>l),
 el número de threads del servidor de NFS puede estar entre 16 y 32 por 
CPU o 16 threads por cada 10Mb/s de velocidad de la red. Obviamente, la 
velocidad de los discos también va a influir.</figcaption></figure><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjIyMSIgdmlld0JveD0iMCAwIDEwMjQgMjIxIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/10/image-3-1024x221.png" alt="Optimizacion del numero de threads en el servidor de NFS" title="Configuración de un Servidor NFS en Linux 16" data-srcset="https://puerto53.com/wp-content/uploads/2021/10/image-3-1024x221.png 1024w, https://puerto53.com/wp-content/uploads/2021/10/image-3-300x65.png 300w, https://puerto53.com/wp-content/uploads/2021/10/image-3-768x166.png 768w, https://puerto53.com/wp-content/uploads/2021/10/image-3.png 1166w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="221"><figcaption>El resultado de las pruebas de rendimiento de NFS han sido:</figcaption></figure><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjEwNSIgdmlld0JveD0iMCAwIDEwMjQgMTA1Ij48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBzdHlsZT0iZmlsbDojY2ZkNGRiO2ZpbGwtb3BhY2l0eTogMC4xOyIvPjwvc3ZnPg==" data-src="https://puerto53.com/wp-content/uploads/2021/10/image-4-1024x105.png" alt="Pruebas de rendimiento NFS aumentando el numero de threads" title="Configuración de un Servidor NFS en Linux 17" data-srcset="https://puerto53.com/wp-content/uploads/2021/10/image-4-1024x105.png 1024w, https://puerto53.com/wp-content/uploads/2021/10/image-4-300x31.png 300w, https://puerto53.com/wp-content/uploads/2021/10/image-4-768x79.png 768w, https://puerto53.com/wp-content/uploads/2021/10/image-4.png 1070w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="105"><figcaption>A
 nivel de CPU (14%) y memoria (1%) no ha habido afectación y la 
velocidad a aumentado de manera espectacular haciendo la prueba desde un
 cliente NFS.<p>Las <strong>conclusiones</strong> que saco de estas pruebas son:</p></figcaption></figure><ul><li>El rendimiento tanto de lectura como de escritura es mejor en local que a través de NFS, tal y como cabía esperar.</li><li>El disco Ultraperformance puede ser hasta un 44% más rápido, en función de la carga del momento.</li><li>Los clientes NFS en los servidores físicos son tres veces más rápidos que los clientes NFS en servidores virtuales.</li><li>Cuántas
 más CPUs y velocidad de red tenga el servidor de NFS, más threads de 
NFS se pueden arrancar y, por lo tanto, mayores velocidades de lectura y
 escritura se pueden alcanzar cuando hay muchos clientes NFSs realizando
 operaciones de lectura y escritura de manera simultánea.</li></ul><h2><span id="Entonces_%C2%BFcon_que_opciones_de_montaje_nos_quedamos"></span>Entonces, ¿con qué opciones de montaje nos quedamos?<span></span></h2><h3><span id="Servidor_NFS"></span>Servidor NFS<span></span></h3><p><strong>El filesystem lo crearemos de tipo XFS</strong>, pues hemos visto que rinde mejor que EXT4.</p><p><strong>Lo exportaremos con las opciones sync y rw</strong>. Aunque async tiene un rendimiento muy superior a sync, sync es mucho más seguro cuando se trata de almacenar los datos.</p><p>async
 significa que las escrituras en disco no se realizan inmediatamente, 
sino que se encolan para ser escritas lo antes posible. Los comandos 
encargados de escribir datos no tienen que esperar a que se complete la 
escritura. En caso de una caída del servicio, podríamos tener corrupción
 de datos.</p><p>En el man del propio exports podemos ver la siguiente advertencia:</p><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjcyIiB2aWV3Qm94PSIwIDAgMTAyNCA3MiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgc3R5bGU9ImZpbGw6I2NmZDRkYjtmaWxsLW9wYWNpdHk6IDAuMTsiLz48L3N2Zz4=" data-src="https://puerto53.com/wp-content/uploads/2021/04/image-16-1024x72.png" alt="image 16" title="Configuración de un Servidor NFS en Linux 18" data-srcset="https://puerto53.com/wp-content/uploads/2021/04/image-16-1024x72.png 1024w, https://puerto53.com/wp-content/uploads/2021/04/image-16-300x21.png 300w, https://puerto53.com/wp-content/uploads/2021/04/image-16-768x54.png 768w, https://puerto53.com/wp-content/uploads/2021/04/image-16-1536x108.png 1536w, https://puerto53.com/wp-content/uploads/2021/04/image-16.png 1806w" data-sizes="(max-width: 1024px) 100vw, 1024px" class="moz-reader-block-img" moz-reader-center="true" width="1024" height="72"><figcaption>Configuración de un Servidor NFS en Linux 34</figcaption></figure><p>Aumentaremos el <strong>número de threads</strong>
 en la configuración del servidor de NFS en función de los recursos de 
CPU, memoria, velocidad de red y velocidad de disco. Se estima que 
podemos configurar unos 16 threads por CPU.</p><h3><span id="Cliente_NFS"></span>Cliente NFS<span></span></h3><p>Las opciones de montaje que recomiendo son:</p><p><strong>vers=4,sync,noatime,rw,hard,timeo=600,retrans=30</strong></p><ul><li>async:
 En caso de caída del cliente, en el servidor NFS no habrá ningún 
impacto porque todavía no se habrán escrito los datos, por lo que no 
tendremos corrupción de datos. No obstante, dependiendo del tipo de 
aplicación, podríamos tener alguna incongruencia, pues la aplicación 
podría creer que sí se ha escrito el dato pero realmente no lo ha hecho y
 podríamos obtener un mal funcionamiento de la aplicación.</li><li>noatime:
 Se utiliza para guardar un registro del último acceso a un archivo. No 
hace falta que el cliente NFS controle este parámetro, ya que es 
redundante, pues el servidor NFS ya lo controla.</li><li>hard: No hemos 
visto grandes diferencias de rendimiento entre hard y soft pero hard es 
la opción conveniente para asegurar la integridad de los datos en caso 
de caída del servicio. Lo que hace hard es bloquear el estado de la 
petición escritura en disco hasta que el servicio vuelva a estar 
operativo de nuevo para continuar en el punto exacto en que la operación
 quedó congelada. La desventaja de soft es que, en caso de caída, la 
aplicación no sepa qué datos se pudieron escribir realmente en disco.</li><li>vers=4: se refiere al uso de NFS4</li><li>timeo=600,retrans=30:
 se refiere a que el cliente NFS realizará 30 intentos de 60 segundos 
para volver a conectar con el servidor de NFS. timeo se escribe en 
decenas de segundos.</li></ul><p>Como podemos comprobar, las opciones 
recomendadas no son las que mejor rendimiento dan pero suponen un 
equilibrio entre rendimiento y seguridad.</p><h3><span id="Opciones_de_montaje_NFS_para_Oracle_RMAN"></span>Opciones de montaje NFS para Oracle RMAN<span></span></h3><p>Algunos
 servicios o aplicaciones requieren unas opciones de montaje especiales 
en el lado del cliente NFS como, por ejemplo, RMAN de Oracle. Las 
opciones a utilizar en este caso son:</p><p>vers=4,rw,bg,hard,rsize=32768,wsize=32768,proto=tcp,timeo=600,nolock</p><h2><span id="%C2%BFComo_modificar_el_numero_de_threads_en_el_servidor_de_NFS"></span>¿Cómo modificar el número de threads en el servidor de NFS?<span></span></h2><p>En Linux RedHat 6 y 7, lo haremos modificando la directiva <em>RPCNFSDCOUNT=16</em>, del fichero <em>/etc/sysconfig/nfs</em>, sustituyendo el número 16 por el que hayamos calculado, según lo explicado anteriormente.</p><p>En RedHat 8, modificaremos la directiva <em>threads=8</em> del fichero <em>/etc/nfs.conf</em>.</p><p>Tras modificar el fichero de configuración, reiniciaremos el servicio de NFS.</p><h2><span id="Configurar_un_directorio_virtual_con_NFS4"></span>Configurar un directorio virtual con NFS4<span></span></h2><p>Con
 la llegada de NFS4, existe un nuevo concepto a la hora de compartir 
filesystems por red, que consiste en la creación de un filesystem o 
directorio virtual que se utiliza para <strong>enjaular</strong> todos los subdirectorios que se van a exportar vía NFSv<span>4</span>.</p><p>Es
 decir, tenemos un directorio raíz, por ejemplo /NFS y todos los 
subdirectorios que hay por debajo son los que se exportan a los 
servidores remotos. Por ejemplo: /NFS/directorio1 /NFS/directorio2 
/NFS/directorio3… /NFS/directorioN</p><p>El problema de esta estructura es que no puedes exportar por NFS4 un filesystems que no esté por debajo del directorio raíz.</p><p>Lo he probado en un RedHat 6.9 y el funcionamiento es el siguiente.</p><h3><span id="Configuracion_del_servidor_NFS"></span>Configuración del servidor NFS<span></span></h3><p>En
 el fichero /etc/exports incluímos el parámetro «fsid=0» en el 
filesystem ráiz que va a contener todos los subdirectorios que vamos a 
exportar:</p><p><em>/Nombre_FS_NFS_ROOT servidor1(sync,rw,<strong><span>fsid=0</span></strong>)</em><br><em>/Nombre_FS_NFS_ROOT/subdirectorio1_a_exportar servidor1(sync,rw) servidor2(sync,rw) servidor3(sync,rw)</em></p><h3><span id="Configuracion_del_cliente_NFS"></span>Configuración del cliente NFS<span></span></h3><p>En el cliente de NFS, por ejemplo, <em>servidor1</em>, montaremos el filesystem por NFS4 de la siguiente manera:</p><p><em>mount -t nfs -o vers=<span>4</span> servidor_nfs:<span>/</span>
 /mnt –&gt; Este comando monta el FS raíz y cuando montamos “/” estamos 
haciendo referencia al FS enjaulado en el servidor de NFS, es decir, 
/Nombre_FS_NFS_ROOT.</em><br><em>mount -t nfs -o vers=4 servidor_nfs:<span>/subdirectorio1</span>
 /mnt/subdirectorio1 –&gt; Este comando estaría montando el FS 
/Nombre_FS_NFS_ROOT/subdirectorio1, pero estamos apuntando al path 
relativo debido al enjaulamiento comentado anteriormente.</em></p><h3><span id="Error_mounting_XXX_failed_reason_given_by_server_No_such_file_or_directory"></span>Error mounting XXX failed, reason given by server: No such file or directory<span></span></h3><p>Con este error me volví loco hasta que me di cuenta de una tontería… Como suele pasar.</p><p><strong>El parámetro fsid=0 debe ser único</strong> y no se puede duplicar pero resulta que en el fichero /etc/exports estaba configurado <strong>sólo en algunos filesystems </strong>y en otros no. <strong>Eso está mal</strong> porque fsid=0 sólo debe aparece una sola vez en todo el fichero /etc/exports.</p><p>Cuando
 está configurada esta directiva y se intenta montar el FS con NFS4, el 
protocolo entiende que tiene que ir a buscar el filesystem que 
intentamos montar en el cliente, dentro de path de enjaulamiento del 
servidor (de NFS4, se entiende). Si el directorio no está en ese path 
relativo, pues el comando «mount» no lo va a encontrar y devolverá el 
error.</p><p>Ejemplo del error:</p><p><em>[root@lo02dox3 ~]# mount -vvv -t nfs -o vers=4 lensnax0:/serveis/dades/PRO/NAS02/TME_FS /serveis/dadesnfs/PRO/TME_FS</em><br><em>mount: fstab path: «/etc/fstab»</em><br><em>mount: mtab path: «/etc/mtab»</em><br><em>mount: lock path: «/etc/mtab~»</em><br><em>mount: temp path: «/etc/mtab.tmp»</em><br><em>mount: UID: 0</em><br><em>mount: eUID: 0</em><br><em>mount: spec: «lensnax0:/serveis/dades/PRO/NAS02/TME_FS»</em><br><em>mount: node: «/serveis/dadesnfs/PRO/TME_FS»</em><br><em>mount: types: «nfs»</em><br><em>mount: opts: «vers=4»</em><br><em>final mount options: ‘vers=4’</em><br><em>mount: external mount: argv[0] = «/sbin/mount.nfs»</em><br><em>mount: external mount: argv[1] = «lensnax0:/serveis/dades/PRO/NAS02/TME_FS»</em><br><em>mount: external mount: argv[2] = «/serveis/dadesnfs/PRO/TME_FS»</em><br><em>mount: external mount: argv[3] = «-v»</em><br><em>mount: external mount: argv[4] = «-o»</em><br><em>mount: external mount: argv[5] = «rw,vers=4»</em><br><em>mount.nfs: timeout set for Tue Feb 26 13:00:47 2019</em><br><em>mount.nfs: trying text-based options ‘vers=4,addr=172.24.12.17,clientaddr=10.48.25.20’</em><br><em>mount.nfs: mount(2): No such file or directory</em><br><span><strong><em>mount.nfs: mounting lensnax0:/serveis/dades/PRO/NAS02/TME_FS failed, reason given by server: No such file or directory</em></strong></span><br><em>[root@lo02dox3 ~]#</em></p><p>Lo que hice para solucionarlo fue eliminar todas las directivas <em>fsid=0</em>
 del fichero /etc/exports porque en este servidor de NFS no tengo un 
único directorio raíz. Este servidor NFS exporta filesystems a muchos 
servidores y aplicaciones distintas, cada una con su arquitectura 
heredada de hace años, por lo que enjaular todos los filesystems a 
exportar en otra ruta, representa un cambio de arquitectura y una parada
 de servicio que afecta a los usuarios finales.</p><p>Dicho esto, la 
incidencia se produjo porque, a nivel de comunicaciones hubo un problema
 que impedía montar los filesystems por NFS3, que no tiene en cuenta la 
directiva fsid=0 y, al intentar montar con NFS4, me encontré con el 
error.</p><h2><span id="Escribir_un_fichero_desde_el_cliente_NFS_con_un_usuario_que_no_existe"></span>Escribir un fichero desde el cliente NFS con un usuario que no existe<span></span></h2><p>Sabemos
 que el filesystem en el cliente NFS se montará con el mismo UID y GID 
de los usuarios y grupos propietarios en el servidor NFS. Si no es así, 
obtendremos un error de permiso denegado.</p><p>Por lo tanto, el usuario o grupo que escriba un fichero desde el cliente NFS deberá tener el mismo UID y GID que en el servidor.</p><pre><code>[root@server1 ~]# df -hP /mnt/nas/csw_pro/csw
Filesystem                                   Size  Used Avail Use% Mounted on
server2:/serveis/dades/PRO/NAS01/1104/1104  4.8G   10M  4.6G   1% /mnt/nas/csw_pro/csw
[root@server1 ~]# ls -ld /mnt/nas/csw_pro/csw
drwxr-xr-x 3 54220 grp_csw 4096 Feb 28 11:59 /mnt/nas/csw_pro/csw
[root@server1 ~]# id
uid=0(root) gid=0(root) groups=0(root),45005(uxsup3)
[root@server1 ~]# touch /mnt/nas/csw_pro/csw/test
touch: cannot touch ‘/mnt/nas/csw_pro/csw/test’: Permission denied
[root@server1 ~]#</code></pre><p>El usuario con UID «54220» es el que 
puede escribir en el filesystem pero no está dado de alta en el sistema 
cliente NFS. En este caso es porque escribe un usuario de un <a href="https://puerto53.com/linux/contenedores-dockers-podman-kubernetes/" title="contenedor">contenedor</a> y ese usuario existe dentro del contenedor pero no en el sistema operativo.</p><p>Por lo tanto, para poder escribir con el usuario con UID 54220 desde el sistema operativo cliente, podremos utilizar sudo:</p><pre><code>[root@server1 ~]# sudo -u \#54220 touch /mnt/nas/csw_pro/csw/test
[root@server1 ~]# ls -la /mnt/nas/csw_pro/csw/test
-rw-r--r-- 1 54220 nfsnobody 0 Feb 28 11:59 /mnt/nas/csw_pro/csw/test
[root@server1 ~]# </code></pre><p>Si queremos ejecutar un comando con el usuario inexistente en el cliente NFS:</p><pre><code>[root@server1 ~]# sudo -u \#54220 sh -c "echo test &gt; /mnt/nas/csw_pro/csw/test"
[root@server1 ~]# ll /mnt/nas/csw_pro/csw/test
-rw-r--r-- 1 54220 nfsnobody 5 Mar  3 10:03 /mnt/nas/csw_pro/csw/test
[root@server1 ~]#</code></pre><h2><span id="Errores_comunes_con_el_servicio_de_NFS"></span>Errores comunes con el servicio de NFS<span></span></h2><p>El montaje de un filesystem NFS no tiene ningún secreto pero, a veces, el servicio no funciona como lo debería hacer.</p><p>En
 este artículo explicaré los errores que me he ido encontrando con el 
servicio de NFS, durante la administración profesional de entornos 
Linux.</p><h3><span id="Error_de_NFS_%E2%80%93_server_XXX_not_responding_timed_out"></span>Error de NFS – server XXX not responding, timed out<span></span></h3><p>Recientemente
 he tenido una incidencia con un servidor de NFS de preproducción en el 
que durante unos segundos el cliente de NFS perdía la conectividad, 
afectando a una aplicación muy sensible o, traduciéndolo de otra manera,
 mal desarrollada:</p><pre><code>May 10 06:02:07 servidor2 kernel: nfs: server servidor1 not responding, timed out
May 10 06:02:07 servidor2 kernel: nfs: server servidor1 not responding, timed out
May 10 06:02:08 servidor2 kernel: nfs: server servidor1 not responding, timed out
May 10 06:02:09 servidor2 kernel: nfs: server servidor1 not responding, timed out
May 10 06:02:11 servidor2 kernel: nfs: server servidor1 not responding, timed out
May 10 06:02:11 servidor2 kernel: nfs: server servidor1 not responding, timed out
May 10 06:02:13 servidor2 kernel: nfs: server servidor1 not responding, timed out
May 10 06:02:15 servidor2 kernel: nfs: server servidor1 not responding, timed out</code></pre><p>Para
 solucionarlo, aumenté el timeout en el que el cliente de NFS va a 
seguir intentando acceder al servidor antes de dar el error, 
consiguiendo que el proceso de la aplicación quede bloqueado o 
interrumpido por IO hasta que reciba respuesta del sistema operativo. 
Las opciones de montaje configuradas en el /etc/fstab han sido:</p><pre><code>ServidorNFS:/FS_SERVIDOR_NFS   /PUNTO_DE_MONTAJE        nfs     vers=4,timeo=60,retrans=60,rw,intr,suid       0 0</code></pre><p>Destacar los parámetros timeo=<em>60</em> y <em>retrans=60.</em></p><ul><li>timeo: Es el tiempo en decenas de segundos que el cliente de NFS espera antes de realizar un nuevo intento.</li><li>retrans: Es el número de reintentos que el cliente de NFS hace para conectarse al servidor.</li></ul><p>El
 motivo de este problema se debió a que el servidor de NFS es un 
servidor virtual de VMWare (preproducción) que quedaba congelado unos 
segundos cuando se realizaba un snapshot para la copia de seguridad 
diaria. Como vemos, las horas coinciden con las de los mensajes de 
error.</p><div><figure><img data-lazyloaded="1" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MDAiIGhlaWdodD0iNjQ4IiB2aWV3Qm94PSIwIDAgOTAwIDY0OCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgc3R5bGU9ImZpbGw6I2NmZDRkYjtmaWxsLW9wYWNpdHk6IDAuMTsiLz48L3N2Zz4=" data-src="https://puerto53.com/wp-content/uploads/2019/05/VMWARE-snapshot.png.webp" alt="Snapshot de VMWare" title="Configuración de un Servidor NFS en Linux 19" data-srcset="https://puerto53.com/wp-content/uploads/2019/05/VMWARE-snapshot.png.webp 900w, https://puerto53.com/wp-content/uploads/2019/05/VMWARE-snapshot-300x216.png.webp 300w, https://puerto53.com/wp-content/uploads/2019/05/VMWARE-snapshot-768x553.png.webp 768w, https://puerto53.com/wp-content/uploads/2019/05/VMWARE-snapshot-640x461.png.webp 640w" data-sizes="(max-width: 900px) 100vw, 900px" class="moz-reader-block-img" moz-reader-center="true" width="900" height="648"></figure></div><p>El cliente de NFS era un RedHat 7.3 y el servidor un RedHat 6.5.</p><h3><span id="RPC_fragment_too_large"></span><em>RPC: fragment too large</em><span></span></h3><p>En
 este caso me encontré con que el servicio de NFS había dejado de 
funcionar puntualmente y luego se recuperó solo sin que tuviese que 
hacer nada.</p><pre><code>[root@server1 ~]# dmesg |tail
RPC: fragment too large: 1090519040
RPC: fragment too large: 469762048
RPC: fragment too large: 1247096314
RPC: fragment too large: 369295616
RPC: fragment too large: 1224736768
RPC: fragment too large: 1404416
RPC: fragment too large: 1986359923
RPC: fragment too large: 870215
RPC: fragment too large: 1701738089
RPC: fragment too large: 2130706432
[root@server1 ~]#
</code></pre><p>En el lado del cliente NFS, al ejecutar un simple <em>df -h</em> la salida del comando se quedaba bloqueada permanentemente sin mostrar ninguna información.</p><p><strong>Causa del problema</strong></p><p>En
 este caso la tarjeta de red que estaba dando el servicio había perdido 
link. El servicio se recuperó automáticamente, gracias a la <a href="https://puerto53.com/linux/configuracion-de-la-red-en-linux/">configuración del bonding</a>.</p><p>Sin embargo, este problema puede tener otra causa derivada de una reducción de la memoria del servidor NFS.</p><p>Cuando arranca el sistema operativo, el parámetro <em>max_block_size</em>, se calcula automáticamente en función de la memoria que tiene el servidor.</p><pre><code>[root@server1 ~]# cat /proc/fs/nfsd/max_block_size
524288
[root@server1 ~]#
</code></pre><p>En base a este valor, los clientes NFS pueden leer y escribir en los filesystems compartidos con este tamaño de bloque máximo.</p><p>Ahora
 bien, si se reduce la memoria del servidor NFS y el tamaño de bloque 
máximo es menor al que hay configurado en los clientes NFS, obtendremos 
el error <em>RPC: fragment too large.</em></p><p>Lo que tenemos que 
hacer si disminuimos la memoria del servidor NFS, es volver a montar los
 filesystems en los clientes para que vuelvan a adquirir los nuevos 
valores de <em>rsize</em> y <em>wsize</em> (tamaños de bloque de lectura y escritura).</p><h3><span id="mountnfs_Protocol_not_supported"></span>mount.nfs: Protocol not supported<span></span></h3><p>No
 nada como empezar la jornada laboral con una serie de filesystems NFS 
desmontados sin saber por qué. Pero, tirando del hilo, vemos que el 
equipo de comunicaciones ha cerrado las comunicaciones de los puertos 
NFS v3 así que, decido montarlo como NFS v4 modificando el fichero 
/etc/fstab de la siguiente manera:</p><p><em>10.48.40.30:/usr/sap/trans_RIX /usr/sap/trans_RIX nfs </em><strong><em>vers=4</em></strong><em>,rw,soft,intr,timeo=14 0 0</em></p><p>Pero, para mi sorpresa, el filesystem no monta, dando el siguiente error:</p><pre><code>[root@server1 ~]# mount /usr/sap/trans_RIX
mount.nfs: Protocol not supported
[root@server1 ~]#</code></pre><p><strong>Solución</strong></p><p>Tras 
estar un rato investigando, me doy cuenta de que en el servidor de NFS, 
alguien había deshabilitado el protocolo NFS v4, lo vuelvo a habilitar y
 reinicio el servicio de NFS:</p><pre><code>[root@lincrix0 ~]# grep RPCNFSDARGS /etc/sysconfig/nfs
#RPCNFSDARGS="-N 2 -N 3"
#RPCNFSDARGS="-N 4"
[root@lincrix0 ~]#</code></pre><p>Luego, reinicio el servidor de NFS:</p><pre><code>service nfs restart</code></pre><p>Y monto el filesystem desde el cliente, esta vez, sin problemas (mount /usr/sap/trans_RIX).</p><h3><span id="kernel_nfsd_peername_failed_err_107"></span>kernel: nfsd: peername failed (err 107)<span></span></h3><p>El
 equipo de aplicaciones me comentaba que, de vez en cuando y de manera 
aleatoria, la aplicación sufría una breve desconexión y no sabían el 
motivo. Resulta que esta aplicación utiliza un filesystem NFS ubicado en
 <strong>un servidor de NFS que ha ido creciendo con el tiempo y, cada vez más, compartía más filesystems con más servidores</strong>.</p><p>Revisando
 el log del sistema operativo (/var/log/messages), aparecían de manera 
puntual, los siguientes mensajes de error de NFS:</p><pre><code>May 22 19:01:33 lensnax1 kernel: nfsd: peername failed (err 107)!
May 22 19:02:07 lensnax1 kernel: nfsd: peername failed (err 107)!
May 22 19:02:07 lensnax1 kernel: nfsd: peername failed (err 107)!
May 22 19:02:07 lensnax1 kernel: nfsd: peername failed (err 107)!
May 22 19:02:07 lensnax1 kernel: nfsd: peername failed (err 107)!
May 22 19:02:07 lensnax1 kernel: nfsd: peername failed (err 107)!</code></pre><p><strong>Las horas coincidían con las desconexiones sufridas por la aplicación.</strong></p><p><strong>Origen del problema</strong></p><p>Por
 lo visto, como el servicio de NFS ha ido creciendo, de vez en cuando, 
los diferentes clientes de NFS realizaban operaciones de lectura y 
escritura simultáneamente y <strong>se llenaba el buffer de memoria TCP del servidor NFS</strong>, causando los errores comentados anteriormente.</p><p>Revisando el problema en la WEB de RedHat, encontré este enlace&nbsp;<a href="https://access.redhat.com/solutions/63171" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/63171</a>, que decía que este error puede deberse a:</p><ul><li>Problemas de red</li><li>Alto tráfico de red</li><li>Problemas en el servidor de NFS</li></ul><p>En mi caso, el problema estaba en el servidor NFS.</p><p><strong>Solución</strong></p><p>Para solucionarlo, modifqué los siguientes parámetros del kernel (RedHat 6&nbsp; – /etc/sysctl.conf):</p><p><em><strong>Valores originales&nbsp;del&nbsp;fichero&nbsp;sysctl.com</strong></em></p><pre><code>net.core.wmem_max = 124928
net.core.rmem_max = 124928
net.core.wmem_default = 124928
net.core.rmem_default = 124928
net.core.netdev_max_backlog = 1000</code></pre><p><em><strong>Nuevos valores</strong></em></p><pre><code>net.core.wmem_max = 1048576
net.core.rmem_max = 4194304
net.core.wmem_default = 1048576
net.core.rmem_default = 4194304
net.core.netdev_max_backlog = 3000</code></pre><p><em><strong>rmem</strong></em><strong> y </strong><em><strong>wmem</strong></em><strong> </strong>es el tamaño en bytes de los <strong>bufferes de memoria para o escribir (wmem) y enviar (rmem) paquetes TCP</strong>, mientras que <em><strong>netdev</strong></em><strong> es el número máximo de paquetes TCP</strong> que pueden encolarse antes de ser procesados.</p><p>Después de este cambio, ya no he vuelto a volver a ver estos mensajes de error.</p><h3><span id="Stale_file_handle"></span>Stale file handle<span></span></h3><p>Me
 he encontrado con un servidor que no podía acceder un filesystem por 
NFS, pero este mismo FS sí que estaba accesible por otros cuatro 
servidores diferentes.</p><p>El error que daba era el siguiente:</p><pre><code>[root@server1 ~]# ls -la /mnt/nas/jtc_pre/pscp
ls: cannot access /mnt/nas/jtc_pre/pscp: Stale file handle
[root@server1 ~]#</code></pre><p>Por mi parte he intentado varias cosas para tratar de solucionarlo pero ninguna de ellas ha funcionado:</p><ul><li>Desmontar y volver a montar el FS:</li></ul><pre><code>umount -f /mnt/nas/jtc_pre/pscp
mount /mnt/nas/jtc_pre/pscp</code></pre><ul><li>Eliminar la caché de filesystems y volver a montar el FS:</li></ul><pre><code># To free pagecache
echo 1 &gt; /proc/sys/vm/drop_caches

# To free dentries and inodes
echo 2 &gt; /proc/sys/vm/drop_caches

# To free pagecache, dentries and inodes
echo 3 &gt; /proc/sys/vm/drop_caches</code></pre><ul><li>Reiniciar el servidor de NFS</li></ul><p><strong>Solución</strong></p><p>Este
 FS se estaba montando con NFSv4 en las opciones de fstab. Lo que he 
hecho ha sido montarlo manualmente con NFSv3 y ha funcionado. Desconozco
 el motivo. Probablemente se deba a algún bug de NFS4.</p><pre><code>[root@server1~]# mount -t nfs -o vers=3,rw,suid,soft,intr,timeo=300,retrans=5 lcttnat1:/serveis/dades/PRE/NAS01/857_pre_psp/pscp_pre /mnt/nas/jtc_pre/pscp
[root@lsltsax5 ~]# ls -la /mnt/nas/jtc_pre/pscp
total 5860
drwxrwxr-x    26 pscp_pre pscp_pre    4096 Dec 15 16:34 .
drwxr-xr-x     4 root     root          46 Dec  4 10:00 ..
drwxrwx---     4 pscp_pre pscp_pre    4096 Apr 28  2010 customizedProfiles
drwxrwx---     2 pscp_pre pscp_pre    4096 Jun  1  2016 dogcTemplates
</code></pre><h3 id="block-522bea67-44ee-4664-b263-a839ce94efc0"><span id="Los_ficheros_se_ven_con_el_propietario_nobody_nobody_en_el_cliente_NFS_con_NFS4"></span>Los ficheros se ven con el propietario nobody:nobody en el cliente NFS con NFS4<span></span></h3><p>Según podemos ver en <a href="https://access.redhat.com/solutions/33455" target="_blank" rel="noreferrer noopener">este artículo de RedHat</a>, el problema se soluciona configurando el servicio idmapd con el mismo dominio en el lado del cliente y del servidor NFS:</p><pre><code>[root@servidor1 etc]# grep Domain /etc/idmapd.conf
#Domain = local.domain.edu
Domain = midominio.com 
[root@servidor1 etc]#</code></pre><p>Luego tenemos que deshabilitar el idmapping:</p><pre><code>Cliente NFS

# echo 'Y' &gt; /sys/module/nfs/parameters/nfs4_disable_idmapping

Servidor NFS

# echo 'Y' &gt; /sys/module/nfsd/parameters/nfs4_disable_idmapping</code></pre><p>Una
 vez configurado el fichero, reiniciamos el servicio rpcidmapd 
(systemctl restart rpcidmapd) y hacemos el umount y el mount del FS para
 que monte con el usuario correcto (no sirve el remount). Es posible que
 tengamos que limpiar la caché de NFS (nfsidmap -c) o, incluso, 
reiniciar el servidor.</p><h3><span id="El_servidor_de_NFS_no_responde_pero_hay_comunicacion"></span>El servidor de NFS no responde pero hay comunicación<span></span></h3><p>He
 tenido algunas incidencias con el montaje de filesystems NFS que me ha 
costado mucho tiempo resolver o averiguar su causa. Como ejemplo:</p><ul><li>Tengo <strong>un filesystem en un cliente NFS que apunta a un servidor de NFS que se ha quedado colgado.</strong> Esto quiere decir, que si intento hacer un «cd» o un «df» del FS el comando se queda colgado eternamente.</li><li>En el mismo cliente NFS tengo otro filesystem NFS que sí monta correctamente hacia el mismo servidor NFS.</li><li>Obviamente, el /etc/exports del servidor está configurado correctamente y no hay problemas de enrutamiento y reglas de firewall.</li><li>En
 el log del sistema veo errores del tipo «kernel: nfs: server 
servidor_nfs not responding, timed out» pero el servidor de NFS está 
arrancado, el servicio también y NO hay problemas de reglas de 
firewalls.</li><li>El comando mount nunca monta el filesystem. Se queda colgado eternamente.</li></ul><p>Para volverse loco, ¿verdad? Pues bien, según podemos leer en el <a href="https://www.suse.com/support/kb/doc/?id=000019722" target="_blank" rel="noreferrer noopener">siguiente documento de SUSE</a> y en <a href="https://access.redhat.com/solutions/2979751" target="_blank" rel="noreferrer noopener">este otro de RedHat</a>,<strong> los elementos de red más modernos, como pueden ser routers, <a href="https://puerto53.com/hardware/switch-ethernet/">switches</a>
 o firewalls tienen un cierto nivel de inteligencia que puede considerar
 maliciosos ciertos tipos o comportamientos de conexiones y las pueden 
bloquear automáticamente por seguridad</strong>.</p><p>La solución a 
esto pasa por reiniciar el elemento de red (router, etc.) o el cliente 
de NFS. Hacer un «umount -f -l » del FS afectado en el cliente no 
servirá para nada.</p><p>Como sabemos, una conexión tiene cuatro elementos básicos:</p><ul><li>IP del cliente NFS</li><li>Puerto origen del cliente NFS</li><li>IP del servidor NFS</li><li>Puerto destino del servidor NFS</li></ul><p>Algunas
 aplicaciones, como NFS, reutilizan la misma conexión. De hecho, es una 
práctica recomendada en la normativa RFC 1122. Pero si esta conexión se 
interrumpe por cualquier motivo y el cliente NFS la vuelve a reutilizar 
(mismo puerto origen), el elemento de red inteligente podría 
interpretarla como maliciosa y bloquearla.</p><h3><span id="Te_puede_interesar"></span>Te puede interesar<span></span></h3><ul><li><a href="https://puerto53.com/linux/gluster-filesystems-con-alta-disponibilidad/">Configuración de GlusterFS</a></li><li><a href="https://puerto53.com/linux/configuracion-de-samba-en-linux/">Configuración de Samba en Linux</a></li><li><a href="https://puerto53.com/linux/guia-de-ceph/">Configuración de Ceph Storage en Linux</a></li><li><a href="https://puerto53.com/linux/replica-de-filesystems-con-drbd/">Réplica de datos con DRBD</a></li><li><a href="https://puerto53.com/linux/compresion-de-datos-en-linux-con-vdo/">Deduplicación y compresión de datos con VDO</a></li></ul></div></div></div>
      </div>

      <div>
        <div class="reader-message"></div>
      </div>
      <div aria-owns="toolbar"></div>
    </div>

    <div id="pocket-cta-container" hidden="">
      <div class="pocket-cta-inner" id="pocket-cta-only">
        <div class="pocket-cta">
          <header class="pocket-cta-header">
            Save anything from across the web in Pocket, your personal library.
          </header>
          <p class="pocket-cta-subhead">
            As part of the Firefox family, Pocket provides a quiet, calm space
            that’s perfect for reading. It strips away all the distractions of
            the internet so you can really focus.
          </p>
          <a href="https://getpocket.com/signup?utm_source=firefox_reader&amp;utm_medium=variant_cta_only" class="pocket-btn pocket-sign-up"><strong>Sign up</strong> - it’s free</a>
          <a href="https://getpocket.com/explore?utm_source=firefox_reader&amp;utm_medium=variant_cta_only" class="pocket-btn pocket-discover-more"><strong>Discover more</strong></a>
        </div>
        <button class="pocket-dismiss-cta" title="Dismiss"></button>
      </div>

      <div class="pocket-cta-inner" id="pocket-cta-and-recs">
        <div class="pocket-recs-top">
          <div class="col">
            <header class="pocket-cta-header">
              Discover the most thought-provoking stories out there, curated by
              Pocket.
            </header>
            <p class="pocket-cta-subhead">
              As part of the Firefox family, Pocket surfaces the best articles
              out there—new perspectives, intriguing deep-dives, timeless
              classics—and we do this with the same dedication to privacy you’ve
              come to expect from Firefox and Mozilla.
            </p>
          </div>
          <div class="col">
            <button class="pocket-collapse-recs"></button>
          </div>
        </div>

        <div class="pocket-recs"></div>

        <div class="pocket-sign-up-wrapper">
          <a href="https://getpocket.com/explore?utm_source=firefox_reader&amp;utm_medium=variant_cta_plus_recs" class="pocket-btn pocket-sign-up"><strong>Discover more</strong></a>
        </div>
      </div>
    </div>
  

</body></html>
